<br/>
<script>
setInterval("doSomething()", 5000);
var threshold = 5;
var current = 5;
function doSomething ()  {
	var numhidden = $('.slideshow').children().length;
	if(numhidden > threshold)           {   
		if(current >= numhidden)
			current = 0;
		$('.slideshow .show').attr('class', 'hide');   
		var max = current + threshold;
		if(max > numhidden)
			max = numhidden;
		for(var i=current; i<max;i++)     
			$(".slideshow").find('a').eq(i).attr('class', 'show');
		current = max;
	}
} 

jQuery(document).ready(function(){
});
</script>
<?php 
global $base_url; 
?>
<p><b>
This page is a curation interface for aggregating data from
the googlegroup <a href='https://groups.google.com/group/indiantreepix'> indiatreepix </a> </b>
</p>
<p>
<b>This is an alpha site and is not open to public. </b>

</p>
<?php
$flag = flag_get_flag('itp_validated');
print "<div class=itp_content>";
if($flag->is_flagged($node->nid))
        print "<div class=validated title='This Content is validated'></div>";
else
        print "<div class=notvalidated title='This Content is not validated'></div>";
if (user_access('administer flags')) 
    print flag_create_link('itp_validated', $node->nid);
?>
<div  class='link_ss'> <a href="#" onclick="Lightbox.triggerLightbox('lightshow', 'treepix');">slideshow</a> </div>
<?php print "</div>";   ?>
<div class="field field-type-filefield field-field-indiatreepix-image">
  <div class="field-items">
    <div class="slideshow">
    <?php 
      $num = 0;
      foreach ((array)$node->field_indiatreepix_image as $item) { ?>
      <?php 
$num = $num + 1;
$file_path = drupal_urlencode($item['filepath']);
if($num > 5)
  print "<a class=hide href=$base_url/$file_path rel=lightshow[treepix][caption $num] title=lightbox><img class=lightboxicon src =$base_url/$file_path /> </a>";
else 
   print "<a class=show href=$base_url/$file_path rel=lightshow[treepix][caption $num] title=lightbox><img class=lightboxicon src =$base_url/$file_path /> </a>";
?>
    <?php } ?>
    </div>
  </div>
</div>
<br/>
<?php
$headers = array();
$data = array();
$highlighters = array();

$row = array();
$row[] = 'Species Name';
$view = '';
foreach ((array)$node->field_species_name as $item) { 
      $view = $view . $item['view'] . '<br/>';
}
$row[] = $view;
$data[] = $row;

$row = array();
$row[] = 'Date/Time';
$row[] = $node->field_date_time[0]['view'];
$data[] = $row;

$row = array();
$row[] = 'Submitted by';
$row[] = $node->field_itp_submitted_by[0]['view'];
$data[] = $row;
$highlighters['hsubmitted'] = $node->field_itp_submitted_by[0]['value'];

$row = array();
$row[] = 'Location';
$row[] = $node->field_indiatreepix_location[0]['view'];
$data[] = $row;
$highlighters['hlocation'] = $node->field_indiatreepix_location[0]['value'];

$row = array();
$row[] = 'Height/Length';
$row[] = $node->field_height_length[0]['view'];
$data[] = $row;
$highlighters['hhl'] = $node->field_height_length[0]['value'];

$row = array();
$row[] = 'Habitat';
$row[] = $node->field_itp_habitat[0]['view'];
$data[] = $row;
$highlighters['hhabitat'] = $node->field_itp_habitat[0]['value'];

$row = array();
$row[] = 'Plant Habit';
$row[] = $node->field_itp_planthabitat[0]['view'];
$data[] = $row;
$highlighters['hphabitat'] = $node->$node->field_itp_planthabitat[0]['value'];

$row   = array();
$row[] = 'Sub family';
$row[] = $node->field_itp_subfamily[0]['view'];
$data[] = $row;
$highlighters['hsfamily'] = $node->field_itp_subfamily[0]['value'];

$row   = array();
$row[] = 'Tribe';
$row[] = $node->field_itp_tribe[0]['view'];
$data[] = $row;
$highlighters['htribe'] = $node->field_itp_tribe[0]['value'];

$row   = array();
$row[] = 'Leaves Type/ Shape/ Size';
$row[] = $node->field_itp_leaves_type[0]['view'];
$data[] = $row;
$highlighters['hltype'] = $node->field_itp_leaves_type[0]['value'];

$row   = array();
$row[] = 'Inflorescence Type/ Size';
$row[] = $node->field_itp_inflorescence_type[0]['view'];
$data[] = $row;
$highlighters['hinflorescence'] = $node->field_itp_inflorescence_type[0]['value'];

$row   = array();
$row[] = 'Flowers Size/ Colour/ Calyx/ Bracts';
$row[] = $node->field_itp_flowers_size[0]['view'];
$data[] = $row;
$highlighters['hfsize'] = $node->field_itp_flowers_size[0]['value'];

$row   = array();
$row[] = 'Fruits Type/ Shape/ Size Seeds';
$row[] = $node->field_itp_fruits_type[0]['view'];
$data[] = $row;
$highlighters['hftype'] = $node->field_itp_fruits_type[0]['value'];

$row   = array();
$row[] = 'Miscellaneous';
$row[] = $node->field_itp_miscellaneous[0]['view'];
$data[] = $row;
$highlighters['hmscs'] = $node->field_itp_miscellaneous[0]['value'];

print theme_table($header, $data, array('class'=>'itp_table'));
?>

<div class="field field-type-text field-field-itp-mail-text">
  <h3 class="field-label">Source Text</h3>
  <div class="field-items">
      <div class="field-item">
<?php 
$keywords = explode(KEYWORD_SEPERATOR, $node->field_matching_string[0]['value']);

$mailtext =  $node->field_itp_mail_text[0]['view'];
foreach ($keywords as $keyword)     {
     if($keyword)
         $mailtext = highlight_words($mailtext, $keyword);           
}

//Highlight other matching words
foreach ($highlighters as $key => $value)
         $mailtext = highlight_words($mailtext, $value, $key);
print $mailtext;
 ?>
       </div>
  </div>

</div>